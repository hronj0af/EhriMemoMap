@inject NavigationManager NavManager
@inject MapStateService MapState

@if (MapState.IsMobileView == true)
{
    <div style="background-color:var(--Wine-Red);color:var(--Beige);position:absolute;top:0px;left:0px;width:100%;z-index:1001;">
        <RadzenRow AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween" Style="padding:10px">
            @if (MapState?.Map?.InitialVariables?.AllCities != null && MapState.Map.InitialVariables.AllCities.Count() > 0)
            {
                <RadzenColumn Size="6">
                    <h2 style="cursor:pointer" onclick="@(() => ShowAllCities())">MemoMap</h2>
                </RadzenColumn>
            }
            else
            {
                <RadzenColumn Size="6">
                    <h2 style="cursor:pointer" onclick="@(() => ShowHome())">MemoMap</h2>
                </RadzenColumn>
            }
            <RadzenColumn Size="6">
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.End">
                    <HelpButton MobileVersion="true" />
                    <LanguageButton MobileVersion="true" />
                </RadzenStack>
            </RadzenColumn>
        </RadzenRow>
    </div>
}

@code {

    private void ShowHome()
    {
        NavManager.NavigateTo("/", true);
    }

    protected override void OnInitialized()
    {
        MapState.OnChange += StateHasChanged;
    }

    public void Dispose()
    {
        MapState.OnChange -= StateHasChanged;
    }

    private async Task ShowAllCities()
    {
        await MapState.SetDialog(MapState.DialogType == DialogTypeEnum.AllCities ? DialogTypeEnum.None : DialogTypeEnum.AllCities);
        MapState.NotifyStateChanged();
    }

}